# Luban 配置解决方案 - 代码使用

> 本文档介绍 Luban 配置系统的各种使用方法，向 AI 咨询时可参考此文档

## 目录

1. [基础用法](./01-入门.md) - 初始化和基本读取
2. [配置创建](./02-配置.md) - 配置表定义
3. [配置加载](./03-配置加载.md) - 加载配置数据
4. [配置查询](./04-配置查询.md) - 查询配置数据
5. [关联查询](./05-关联查询.md) - 配置表关联
6. [数据导出](./06-数据导出.md) - 导出和热更
7. [特殊类型](./07-特殊类型.md) - 枚举/数组/字典

---

## 3. 配置加载

### 全量加载

```csharp
// 加载所有配置
LubanHelper.LoadAll();

// 加载指定表
LubanHelper.LoadTable("table_name");
```

### 异步加载

```csharp
// 异步加载
await LubanHelper.LoadTableAsync<T>();
```

### 热更加载

```csharp
// 热更配置
await LubanHelper.Reload();
```

---

## 4. 配置查询

### 根据 ID 查询

```csharp
// 获取单个配置
var config = TableNameCategory.Instance.Get(id);

// 检查存在
if (TableNameCategory.Instance.Get(id) != null) { }
```

### 遍历查询

```csharp
// 遍历所有
foreach (var config in TableNameCategory.Instance.GetAll()) { }

// 条件查询
TableNameCategory.Instance.GetAll().Where(x => x.Level > 10);
```

### 多条件查询

```csharp
// 根据多个字段查询
TableNameCategory.Instance.GetAll().FirstOrDefault(x => 
    x.Type == type && x.Quality == quality);
```

---

## 5. 关联查询

### 主表查子表

```csharp
// 角色配置关联技能
var skillIds = characterConfig.SkillIds;
foreach (var skillId in skillIds)
{
    var skill = SkillConfigCategory.Instance.Get(skillId);
}
```

### 子表查主表

```csharp
// 技能查所属角色
var allChars = CharacterConfigCategory.Instance.GetAll()
    .Where(x => x.SkillIds.Contains(skillId));
```

### 双向关联

```csharp
// 装备强化关联材料
var materials = equipConfig.GetMaterials();
```

---

## 6. 数据导出

### 导出命令

```csharp
// 命令行导出
Luban.Program.Main(new[] { "-c", "config" });
```

### Unity 导出

```csharp
// Editor 菜单导出
LubanEditor.Export();
```

### 运行时导出

```csharp
// 运行时导出（开发用）
await LubanHelper.ExportBytes();
```

---

## 7. 特殊类型

### 枚举类型

```csharp
// 读取枚举
var job = config.Job;  // Job 枚举

// 枚举转字符串
job.ToString();
```

### 数组类型

```csharp
// 读取数组
var skills = config.SkillIds;  // int[]

// 遍历
foreach (var id in skills) { }
```

### 字典类型

```csharp
// 读取字典
var attrs = config.Attrs;  // Dictionary<int, long>

// 查询
var attack = attrs.GetValueOrDefault(1, 0);
```

### 嵌套类型

```csharp
// 读取嵌套对象
var item = config.RewardItem;  // 嵌套类

// 读取嵌套数组
var items = config.RewardItems;  // 嵌套类数组
```
