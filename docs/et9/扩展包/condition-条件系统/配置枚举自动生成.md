# 配置枚举自动生成

# 配置枚举自动生成

 
![Image](/images/CB5ewIAQZiBf1Ykp2DDcMj22nHb_0_81cbc665.png)
 用户7857 
 WPS启用VBA 
 
 
 条件ID & 条件组ID 
 都由VBA自动生成 
 
![Image](/images/GLrnw7344iATxVkMTI5cd7DunDn_1_cdba6e64.png)
 50% 
![Image](/images/GLrnw7344iATxVkMTI5cd7DunDn_2_6c696983.png)
 50% 对应的枚举自动生成 
 本身要这个ID的目的就是防止写魔法数字 
 
![Image](/images/GLrnw7344iATxVkMTI5cd7DunDn_3_9969667c.png)
 
![Image](/images/GLrnw7344iATxVkMTI5cd7DunDn_4_1223ba45.png)
 
 VBA 代码 
 实际的可以在表格中查看具体内容 
 代码块 
 Private Sub 同步_Click() 
 Dim srcWs As Worksheet          '当前 Condition.xlsm 的工作表 
 Dim tgtWb As Workbook           '__enums__.xlsx 
 Dim tgtWs As Worksheet          '目标页签 ConditionId 
 Dim enumPath As String          '相对路径拼出的完整路径 
 Dim lastRow As Long, i As Long 
 
 Set srcWs = ThisWorkbook.ActiveSheet   '也可改成固定名字 
 
 '相对路径：两个文件平级，都在 Config 文件夹下 
 enumPath = ThisWorkbook.Path & "\..\Base\__enums__.xlsx" 
 
 Application.ScreenUpdating = False 
 
 '======= 1. 先把路径算出来 ======= 
 enumPath = ThisWorkbook.Path & "\..\Base\__enums__.xlsx" 
 enumPath = CreateObject("Scripting.FileSystemObject").GetAbsolutePathName(enumPath) '转为绝对路径 
 
 '======= 2. 判断是否已经打开了正确的那一份 ======= 
 Dim bFound As Boolean 
 bFound = False 
 For Each tgtWb In Workbooks 
 If StrComp(tgtWb.FullName, enumPath, vbTextCompare) = 0 Then 
 bFound = True 
 Exit For 
 End If 
 Next tgtWb 
 
 '======= 3. 如果没找到，再按完整路径打开 ======= 
 If Not bFound Then 
 On Error Resume Next 
 Set tgtWb = Workbooks.Open(enumPath, ReadOnly:=False) 
 On Error GoTo 0 
 End If 
 
 If Not bFound And tgtWb Is Nothing Then 
 MsgBox "找不到 __enums__.xlsx，请确认路径正确！注意同名只能存在一个如果有其他enums表打开着请关闭后重试! ", vbExclamation 
 Exit Sub 
 End If 
 
 
 If tgtWb Is Nothing Then 
 MsgBox "找不到 __enums__.xlsx，请确认相对路径正确！", vbExclamation 
 Exit Sub 
 End If 
 
 Set tgtWs = tgtWb.Worksheets("ConditionId")   '目标页签 
 
 '先清空 H5:I999（避免旧数据残留） 
 tgtWs.Range("H5:J9999").ClearContents 
 
 '从 Condition 第 6 行开始向下找，直到 B 列为空 
 lastRow = srcWs.Cells(srcWs.Rows.Count, "B").End(xlUp).Row 
 If lastRow < 6 Then 
 MsgBox "Condition 表 B 列从第 6 行开始没有数据！", vbInformation 
 GoTo CleanExit 
 End If 
 
 Dim tgtRow As Long      '目标写入行号 
 tgtRow = 5              '从 H5 开始写 
 
 '从第 6 行开始扫源表 
 For i = 6 To lastRow 
 '只要 B 或 C 任一列有内容就写一行（可按需要改成两列都必须有） 
 If srcWs.Cells(i, "B").Value <> "" Then 
 tgtWs.Cells(tgtRow, "H").Value = srcWs.Cells(i, "B").Value 
 tgtWs.Cells(tgtRow, "I").Value = srcWs.Cells(i, "C").Value 
 tgtRow = tgtRow + 1       '只有成功写一行才进位 
 End If 
 Next i 
 
 tgtWb.Save 
 
 MsgBox "同步完成！共写入 " & (tgtRow - 5) & " 行。", vbInformation 
 
 CleanExit: 
 Application.ScreenUpdating = True 
 End Sub