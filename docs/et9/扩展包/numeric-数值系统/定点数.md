# 定点数

 
![Image](/images/CB5ewIAQZiBf1Ykp2DDcMj22nHb_0_81cbc665.png)
  ((((a+b)*c)+d)*e)+f 
 其中  a,b,c,d,e,f 均为long类型整数 
 c , e 作为倍数 在实际存储时 放大了10000倍 
 需求: 计算结果向零截断 
 
 ((((基础值 + 附加值) * 百分比因子) + 最终附加) * 最终百分比因子) + 结果附加 
 
 代码块 
 
 var valueBasAdd        = self.GetByKey(bas) + self.GetByKey(add); 
 var valueAfterPct      = valueBasAdd * (NumericConst.IntRate + self.GetByKey(pct)) / NumericConst.IntRate; 
 var valueAfterFinalAdd = valueAfterPct + self.GetByKey(finalAdd); 
 var valueAfterFinalPct = valueAfterFinalAdd * (NumericConst.IntRate + self.GetByKey(finalPct)) / NumericConst.IntRate; 
 var finalResult        = valueAfterFinalPct + self.GetByKey(resultAdd); 
 self.ChangeValue(final, finalResult, isPushEvent, false); 
 
 var result = (long) 
 ( 
 ( 
 ( 
 ( 
 
 // 1 + 2 
 self.GetByKey(bas) + self.GetByKey(add) 
 ) 
 
 // * 3 
 * (NumericConst.IntRate + self.GetByKey(pct)) / NumericConst.IntRate 
 
 // + 4 
 + self.GetByKey(finalAdd) 
 ) 
 
 // * 5 
 * (NumericConst.IntRate + self.GetByKey(finalPct)) / NumericConst.IntRate 
 ) 
 
 // + 6 
 + self.GetByKey(resultAdd) 
 ); 
 
 //最终值 使用覆盖 
 self.ChangeValue(final, result, isPushEvent, false); 
 
 关键结论 
 放大 10000 倍的方法本质上是 一种定点数算法的简化实现 ，但能否保证跨平台一致性取决于 运算规则的设计 。以下是详细分析： 
 1. 为什么放大 10000 倍也是一种定点数算法？ 
 ◦ 核心思想 ：定点数的本质是通过整数运算模拟小数，通过固定缩放因子（如 10000）隐式定义小数点的位置。例如： 
 ▪ 放大 10000 倍等价于使用 Q格式的 Qm.n ，其中 n 是小数位数（ n=4 ，因为 10^4=10000 ）。